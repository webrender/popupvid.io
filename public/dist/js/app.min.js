function MainController(a,b,c,d){a.url="https://www.youtube.com/watch?v=HtDgUHw0IJA",a.colorList=["#7bd148","#5484ed","#a4bdfc","#46d6db","#7ae7bf","#51b749","#fbd75b","#ffb878","#ff887c","#dc2127","#dbadff","#e1e1e1","#ffffff"],a.currentText="",a.selectedEmoji=":wolf:",a.emojiBgColor="#7bd148",currentX=0,currentY=0,a.cardIndex=[],a.resizeEvent=function(){$(".player-container").css("height",.5625*document.body.clientWidth)};var e=angular.element(b);e.bind("resize",a.resizeEvent()),$(".intro").on("hidden.bs.modal",function(b){a.player.playVideo()}),a.resizeEvent=function(){$(".player-container").css("height",.5625*document.body.clientWidth)},a.mouseTracker=function(a){mouseX=a.pageX,mouseY=a.pageY},a.onPlayerStateChange=function(b){1==b.data&&cardOpen&&a.closeCard()},a.pause=function(){1==a.player.getPlayerState()&&(a.player.pauseVideo(),a.displayCard()),2==a.player.getPlayerState()&&(cardOpen?a.closeCard():a.displayCard())},a.displayCard=function(b){if(b){a.currentTime=b.time,a.player.seekTo(b.time),a.player.pauseVideo(),a.currentText=b.text,a.selectedEmoji=b.emoji,a.emojiBgColor=b.bg,$(".card").removeClass("bounceOut").addClass("bounceIn"),$(".card").css({visibility:"visible",top:b.y+"%",left:b.x+"%"});var c=$(".card").offset();window.innerHeight-c.top>335?$(".card-settings").removeClass("top left right").addClass("bottom"):c.top>265?$(".card-settings").removeClass("bottom left right").addClass("top"):c.left>220?$(".card-settings").removeClass("top bottom right").addClass("left"):$(".card-settings").removeClass("top bottom left").addClass("right"),window.setTimeout(function(){$(".card-settings").css("visibility","visible").removeClass("fadeOut").addClass("fadeIn"),cardOpen=!0,$(".current-text").focus()},500)}else{a.currentTime=a.player.getCurrentTime();var d=$(".player-container").offset();currentX=(mouseX-32)/$(".player-container").width()*100,currentY=(mouseY-d.top-32)/$(".player-container").height()*100,$(".card").removeClass("bounceOut").addClass("bounceIn"),$(".card").css({visibility:"visible",top:currentY+"%",left:currentX+"%"}),window.innerHeight-mouseY>390?$(".card-settings").removeClass("top left right").addClass("bottom"):mouseY>265?$(".card-settings").removeClass("bottom left right").addClass("top"):mouseX>220?$(".card-settings").removeClass("top bottom right").addClass("left"):$(".card-settings").removeClass("top bottom left").addClass("right"),window.setTimeout(function(){$(".card-settings").css("visibility","visible").removeClass("fadeOut").addClass("fadeIn"),cardOpen=!0,$(".current-text").focus()},500)}$(".sidebar-wrap").addClass("smaller-hover")},a.picker=function(){$(".card-emoji-input").emojiPicker({height:"100px",width:"200px"})},a.colorSelect=function(b){a.emojiBgColor=b},a.closeCard=function(){$(".card-settings").removeClass("fadeIn").addClass("fadeOut"),window.setTimeout(function(){$(".card").removeClass("bounceIn").addClass("bounceOut"),$(".card-settings").css("visibility","hidden"),$(".sidebar-wrap").removeClass("smaller-hover"),cardOpen=!1,a.player.playVideo(),window.setTimeout(function(){a.currentText="",a.selectedEmoji=":wolf:",a.emojiBgColor="#7bd148",$(".sidebar-wrap").removeClass("small")},500)},500)},a.saveCard=function(){var b={time:a.currentTime,text:a.currentText,emoji:a.selectedEmoji,bg:a.emojiBgColor,x:currentX,y:currentY};if(0===a.cardIndex.length)a.cardIndex[0]=b;else for(var c=0;c<a.cardIndex.length;c++){if(a.cardIndex[c].time===a.currentTime){a.cardIndex[c]=b;break}if(c+1===a.cardIndex.length){a.cardIndex.push(b);break}if(a.cardIndex[c].time>a.currentTime){a.cardIndex.splice(c,0,b);break}}$(".sidebar-wrap").addClass("small"),window.setTimeout(function(){a.closeCard()},500)},a.deleteCard=function(){for(var b=0;b<a.cardIndex.length;b++)if(a.cardIndex[b].time===a.currentTime){a.cardIndex.splice(b,1);break}a.closeCard()},a.enterSidebar=function(){cardOpen||a.player.pauseVideo()},c.on("keypress",function(b){a.player&&!cardOpen&&(1==a.player.getPlayerState()?a.player.pauseVideo():a.player.playVideo())}),a.leaveSidebar=function(){cardOpen||a.player.playVideo()},a.$watch("currentText",function(a){$(".current-text")[0]&&d(function(){$(".current-text").removeClass("medium small").addClass("large"),$(".current-text")[0].clientHeight<$(".current-text")[0].scrollHeight&&$(".current-text").removeClass("large").addClass("medium"),$(".current-text")[0].clientHeight<$(".current-text")[0].scrollHeight&&$(".current-text").removeClass("medium").addClass("small")})})}angular.module("popupvid.io",["ngRoute","appRoutes","MainCtrl","ngSanitize","emojiApp"]),angular.module("appRoutes",[]).config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/home.html",controller:"MainController"}),b.html5Mode(!0)}]);var MainCtrl=angular.module("MainCtrl",[]),player,mouseX,mouseY,cardOpen=!1,sidebarState=0,currentX=0,currentY=0;MainCtrl.directive("urlInput",function(){return function(a,b){b.bind("keyup",function(b){if(13===b.which){b.preventDefault();var c=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,d=a.url.match(c);d&&11==d[2].length&&($(".player-container").show(),a.player=new YT.Player("player",{height:"100%",width:"100%",videoId:d[2],events:{onReady:function(b){a.player.mute(),$(".editor").css({visibility:"visible",opacity:"1"}),$(".intro").modal("show")},onStateChange:a.onPlayerStateChange},playerVars:{playsinline:1,showinfo:0,rel:0,disablekb:1,iv_load_policy:3}}))}})}}),MainCtrl.directive("isDraggable",function(){return{restrict:"A",link:function(a,b,c){b.draggable({cancel:".card-emoji, .card-settings, .card-text",containment:"parent",drag:function(a,b){window.innerHeight-b.offset.top>335?$(".card-settings").removeClass("top left right").addClass("bottom"):b.offset.top>265?$(".card-settings").removeClass("bottom left right").addClass("top"):b.offset.left>220?$(".card-settings").removeClass("top bottom right").addClass("left"):$(".card-settings").removeClass("top bottom left").addClass("right"),currentX=b.offset.left/$(".player-container").width()*100,currentY=b.offset.top/$(".player-container").height()*100}})}}}),MainCtrl.controller("MainController",["$scope","$window","$document","$timeout",MainController]);